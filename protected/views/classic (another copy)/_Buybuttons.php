<form name="tmp_product" id="tmp_product" method="post">
    <input type="hidden" name="tmp_product_id" id="tmp_product_id" value="">
	<input type="hidden" name="tmp_form_size" id="form_size" value="">
    <input type="hidden" name="tmp_form_type" id="tmp_form_type" value="">
    <input type="hidden" name="tmp_chest_size" id="tmp_chest_size" value="">
    <input type="hidden" name="tmp_waist_size" id="tmp_waist_size" value="">
    <input type="hidden" name="tmp_shoulder_length" id="tmp_shoulder_length" value="">
    <input type="hidden" name="tmp_body_length" id="tmp_body_length" value="">
    <input type="hidden" name="tmp_sleeve_length" id="tmp_sleeve_length" value="">
    
    
    
    <input type="hidden" name="tmp_body_color" id="tmp_body_color" value="">
    <input type="hidden" name="tmp_body" id="tmp_body" value="">
    <input type="hidden" name="tmp_back_body" id="tmp_back_body" value="">
    <input type="hidden" name="tmp_body_right" id="tmp_body_right" value="">
    <input type="hidden" name="tmp_body_left" id="tmp_body_left" value="">  
    
    <input type="hidden" name="tmp_sleeves_color" id="tmp_sleeves_color" value="">
    <input type="hidden" name="tmp_front_sleeves" id="tmp_front_sleeves" value="">
    <input type="hidden" name="tmp_back_sleeves" id="tmp_back_sleeves" value="">
    <input type="hidden" name="tmp_right_sleeves" id="tmp_right_sleeves" value="">
    <input type="hidden" name="tmp_left_sleeves" id="tmp_left_sleeves" value="">  
    
    <!-- snap(buttons)-->
    <input type="hidden" name="tmp_snap_color" id="tmp_snap_color" value="">
    <input type="hidden" name="tmp_front_snap" id="tmp_front_snap" value="">
    <input type="hidden" name="tmp_right_snap" id="tmp_right_snap" value="">
    <input type="hidden" name="tmp_left_snap" id="tmp_left_snap" value="">  
    
     <!-- pocket-->
    <input type="hidden" name="tmp_pocket_color" id="tmp_pocket_color" value="">
    <input type="hidden" name="tmp_front_pocket" id="tmp_front_pocket" value="">
    <input type="hidden" name="tmp_right_pocket" id="tmp_right_pocket" value="">
    <input type="hidden" name="tmp_left_pocket"  id="tmp_left_pocket" value="">  
    
     <!-- knit-->
    <input type="hidden" name="tmp_knit_color" id="tmp_knit_color" value="">
    <input type="hidden" name="tmp_front_knit" id="tmp_front_knit" value="">
     <input type="hidden" name="tmp_back_knit" id="tmp_back_knit" value="">
    <input type="hidden" name="tmp_right_knit" id="tmp_right_knit" value="">
    <input type="hidden" name="tmp_left_knit"  id="tmp_left_knit" value="">  
    
    <!-- knit strip-->
    <input type="hidden" name="tmp_knit_stripe_color" id="tmp_knit_stripe_color" value="">
    <input type="hidden" name="tmp_knit_stripe" id="tmp_knit_stripe" value="">
     <input type="hidden" name="tmp_knit_stripe_back" id="tmp_knit_stripe_back" value="">
    <input type="hidden" name="tmp_knit_stripe_right" id="tmp_knit_stripe_right" value="">
    <input type="hidden" name="tmp_knit_stripe_left"  id="tmp_knit_stripe_left" value="">  
    
     <!-- knit double strip-->
    <input type="hidden" name="tmp_double_stripe" id="tmp_double_stripe" value="">
    <input type="hidden" name="tmp_double_stripe" id="tmp_double_stripe" value="">
     <input type="hidden" name="tmp_double_stripe_back" id="tmp_double_stripe_back" value="">
    <input type="hidden" name="tmp_knit_double_stripe_right" id="tmp_knit_double_stripe_right" value="">
    <input type="hidden" name="tmp_knit_double_stripe_left"  id="tmp_knit_double_stripe_left" value="">  
    
    
    <!-- right chest line one-->
    <input type="hidden" name="tmp_rightchest1" id="tmp_rightchest1" value="">
    <input type="hidden" name="tmp_rightchest_txt_color1" id="tmp_rightchest_txt_color1" value="">
     <input type="hidden" name="tmp_rightchest_txt_type1" id="tmp_rightchest_txt_type1" value="">
    
     
      <!-- right chest line two-->
    <input type="hidden" name="tmp_rightchest2" id="tmp_rightchest2" value="">
    <input type="hidden" name="tmp_rightchest_txt_color2" id="tmp_rightchest_txt_color2" value="">
     <input type="hidden" name="tmp_rightchest_txt_type2" id="tmp_rightchest_txt_type2" value="">
     
     
      <!-- left chest-->
    <input type="hidden" name="tmp_leftchest" id="tmp_leftchest" value="">
    <input type="hidden" name="tmp_leftchest_txt_color" id="tmp_leftchest_txt_color" value="">
     <input type="hidden" name="tmp_leftchest_txt_type" id="tmp_leftchest_txt_type" value="">
    
     
     <!-- right arm line one-->
    <input type="hidden" name="tmp_rightarm1" id="tmp_rightarm1" value="">
    <input type="hidden" name="tmp_rightarm_txt_color1" id="tmp_rightarm_txt_color1" value="">
     <input type="hidden" name="tmp_rightarm_txt_type1" id="tmp_rightarm_txt_type1" value="">
    
      <!-- right arm line two-->
    <input type="hidden" name="tmp_rightarm2" id="tmp_rightarm2" value="">
    <input type="hidden" name="tmp_rightarm_txt_color2" id="tmp_rightarm_txt_color2" value="">
     <input type="hidden" name="tmp_rightarm_txt_type2" id="tmp_rightarm_txt_type2" value="">
    
     <!-- left arm line one-->
    <input type="hidden" name="tmp_leftarm1" id="tmp_leftarm1" value="">
    <input type="hidden" name="tmp_leftarm_txt_color1" id="tmp_leftarm_txt_color1" value="">
     <input type="hidden" name="tmp_leftarm_txt_type1" id="tmp_leftarm_txt_type1" value="">
    
      <!-- left arm line two-->
    <input type="hidden" name="tmp_leftarm2" id="tmp_leftarm2" value="">
    <input type="hidden" name="tmp_leftarm_txt_color2" id="tmp_leftarm_txt_color2" value="">
    <input type="hidden" name="tmp_leftarm_txt_type2" id="tmp_leftarm_txt_type2" value="">
    
    
     <!-- back text top-->
    <input type="hidden" name="tmp_back_text" id="tmp_back_text" value="">
    <input type="hidden" name="tmp_back_text_color" id="tmp_back_text_color" value="">
     <input type="hidden" name="tmp_back_text_type" id="tmp_back_text_type" value="">
     
     <!-- back text top-->
    <input type="hidden" name="tmp_back_text1" id="tmp_back_text1" value="">
    <input type="hidden" name="tmp_back_text_color1" id="tmp_back_text_color1" value="">
     <input type="hidden" name="tmp_back_text_type1" id="tmp_back_text_type1" value="">
     
     <input type="hidden" name="tmp_back_text2" id="tmp_back_text2" value="">
    <input type="hidden" name="tmp_back_text_color2" id="tmp_back_text_color2" value="">
     <input type="hidden" name="tmp_back_text_type2" id="tmp_back_text_type2" value="">
    
     
</form> 

  
     <a href="javascript:void(0)" onclick="save_div('buy')"  class="btn buy" ><i>buy now</i></a>
     <?php  if(Yii::app()->user->isGuest){  ?>
     <button class="btn save" type="button" onclick="alert('please login first')"><i>save my jacket</i></button>	  
     <?php }else{ ?>
     <button class="btn save" type="button" id="save-product" ><i>save my jacket</i></button>	  
     <?php } ?>
     
     
<script type="text/javascript" src="<?=Yii::app()->request->baseUrl;?>/js/html2canvas/html2canvas.js"></script>
<script type="text/javascript" src="<?=Yii::app()->request->baseUrl;?>/js/html2canvas/html2canvas.min.js"></script>
<script type="text/javascript" src="<?=Yii::app()->request->baseUrl;?>/js/html2canvas/jquery.plugin.html2canvas.js"></script> 
<script>

function save_div(flag)
{
	html2canvas($('#jacket_div'), {
  onrendered: function(canvas) {

	//canvas.toDataURL("image/png")
    //alert(img);
	//window.open(img);
	 //document.body.appendChild(canvas);
	$.ajax({
                url: '<?=Yii::app()->request->baseUrl?>/classic/captureImage',
                type: 'POST',
                data: { file : canvas.toDataURL("image/png")},
                success: function(data, status){
					//$('body').append("<img src='"+data+"'>");
				//$('#mirror_btn').attr('href','mirror.php?img='+data+'&pro_id=<?=$pro_id?>');	
               // alert("Image Has Been created");
			   //$('#buy_').click();
			   	if(flag=='buy')
				{
			   		window.location='<?=Yii::app()->request->baseUrl?>/home/checkout';
				}
				else
				{
					$('#save_btn_id').click({
                                      //  console.log("hhh");
                                            });
				}
			   
            }
            });
	
	//window.location="mirror.php"

  }
});
}


//$(function(){
$("#save-product").click(function(){

$("#tmp_product").submit();
  }); 
  
$("#tmp_product").submit(function(e){
    e.preventDefault();
    var form_data = $(this).serialize();
    console.log(form_data);
    
        $.ajax({
                url: '<?php echo Yii::app()->createUrl('classic/saveProduct'); ?>',
                type: 'POST',
                //dataType: 'html',
                data: form_data,
                beforeSend: function() {
                },
                success: function(data) {
                    console.log(data);
                    window.location.href="<?php echo Yii::app()->getBaseUrl(true)."/classic/index/id/" ?>"+data;
                   
                },
                error: function(xhr, textStatus, errorThrown) {
                }
            });
});
//    

            
   
 
         
//});

</script>